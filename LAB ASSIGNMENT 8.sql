ALTER SESSION SET NLS_DATE_FORMAT='YYYY-MM-DD';
CREATE TABLE SAILORS(SID INT,SNAME VARCHAR(30),RATING INT,AGE REAL,CONSTRAINT SPK PRIMARY KEY(SID));
CREATE TABLE BOATS(BID INT,BNAME VARCHAR(30),COLOR VARCHAR(10),CONSTRAINT BPK PRIMARY KEY(BID));
CREATE TABLE RESERVES(SID INT,BID INT,DAYY DATE,CONSTRAINT SFK FOREIGN KEY(SID) REFERENCES SAILORS(SID),CONSTRAINT BFK FOREIGN KEY(BID) REFERENCES BOATS(BID));

INSERT INTO SAILORS VALUES(22,'DUSTIN',7,45);
INSERT INTO SAILORS VALUES(29,'BRUTUS',1,33);
INSERT INTO SAILORS VALUES(31,'LUBBER',8,55.5);
INSERT INTO SAILORS VALUES(32,'ANDY',8,25.5);
INSERT INTO SAILORS VALUES(58,'RUSTY',10,35);
INSERT INTO SAILORS VALUES(64,'HORATIO',7,35);
INSERT INTO SAILORS VALUES(71,'ZORBA',10,16);
INSERT INTO SAILORS VALUES(74,'HORATIO',9,35);
INSERT INTO SAILORS VALUES(85,'ART',3,25.5);
INSERT INTO SAILORS VALUES(95,'BOB',3,65.5);

INSERT INTO BOATS VALUES(101,'INTERLAKE','BLUE');
INSERT INTO BOATS VALUES(102,'INTERLAKE','RED');
INSERT INTO BOATS VALUES(103,'CLIPPER','GREEN');
INSERT INTO BOATS VALUES(104,'MARINE','RED');

INSERT INTO RESERVES VALUES(22,101,'1998-10-10');
INSERT INTO RESERVES VALUES(22,102,'1998-10-10');
INSERT INTO RESERVES VALUES(22,103,'1998-08-10');
INSERT INTO RESERVES VALUES(22,104,'1998-07-10');
INSERT INTO RESERVES VALUES(31,102,'1998-10-11');
INSERT INTO RESERVES VALUES(31,103,'1998-06-11');
INSERT INTO RESERVES VALUES(31,104,'1998-12-11');
INSERT INTO RESERVES VALUES(64,101,'1998-05-09');
INSERT INTO RESERVES VALUES(64,102,'1998-08-09');
INSERT INTO RESERVES VALUES(74,103,'1998-08-09');

--Q1
SELECT DISTINCT S.SID, S.SNAME FROM SAILORS S JOIN RESERVES R ON S.SID=R.SID JOIN BOATS B ON B.BID=R.BID WHERE B.COLOR IN ('RED','GREEN');

--Q2
SELECT S.SNAME FROM SAILORS S 
    JOIN RESERVES R ON S.SID=R.SID 
    JOIN BOATS B ON B.BID=R.BID 
    WHERE B.COLOR IN ('RED','GREEN') 
    GROUP BY S.SNAME HAVING COUNT(DISTINCT B.COLOR)=2;

--Q3
SELECT DISTINCT S.SID,S.SNAME FROM SAILORS S
JOIN RESERVES R ON S.SID=R.SID
JOIN BOATS B ON B.BID=R.BID
WHERE B.BID=103;

--Q4
SELECT DISTINCT S.SID,S.SNAME FROM SAILORS S
JOIN RESERVES R ON S.SID=R.SID
JOIN BOATS B ON B.BID=R.BID
WHERE B.COLOR='RED';

--Q5
SELECT DISTINCT S.SID,S.SNAME FROM SAILORS S
JOIN RESERVES R ON S.SID=R.SID
JOIN BOATS B ON B.BID=R.BID
WHERE B.COLOR<>'RED';

--Q6
SELECT DISTINCT S.SID,S.SNAME FROM SAILORS S
JOIN RESERVES R ON R.SID=S.SID;

--Q7
SELECT SID,SNAME FROM SAILORS WHERE RATING>ANY(SELECT RATING FROM SAILORS WHERE SNAME='HORATIO');

--Q8
SELECT SID,SNAME FROM SAILORS WHERE RATING>ALL(SELECT RATING FROM SAILORS WHERE SNAME='HORATIO');

--Q9
SELECT SID,SNAME FROM SAILORS WHERE RATING = (SELECT MAX(RATING) FROM SAILORS);

--Q10
SELECT S.SID, S.SNAME FROM SAILORS S
JOIN RESERVES R ON R.SID=S.SID
JOIN BOATS B ON B.BID=R.BID
GROUP BY S.SID,S.SNAME HAVING COUNT(DISTINCT R.BID) = (SELECT COUNT(DISTINCT BID) FROM BOATS);